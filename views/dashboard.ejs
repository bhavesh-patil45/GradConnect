<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>GradConnect Dashboard</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet" />
  <style>
    body { font-family: 'Inter', sans-serif; }
  </style>
</head>
<body class="bg-gray-100">

  <!-- Header -->
  <header class="bg-white shadow flex justify-between items-center px-6 py-4">
    <h1 class="text-2xl font-bold text-blue-600">GradConnect</h1>
    <p class="text-sm text-gray-600">Welcome, <%= name %> (<%= role %>)</p>
  </header>

  <div class="flex h-[calc(100vh-64px)]">
    
    <!-- Sidebar -->
    <aside class="w-20 bg-white shadow flex flex-col items-center py-6 space-y-6">
      <button onclick="showSection('home')" class="text-2xl hover:text-blue-600" title="Home">üè†</button>
      <button onclick="showSection('chat')" class="text-2xl hover:text-blue-600" title="Chat">üí¨</button>
      <button onclick="showSection('post')" class="text-2xl hover:text-blue-600" title="Post">‚ûï</button>
      <button onclick="showSection('jobs')" class="text-2xl hover:text-blue-600" title="Jobs">üíº</button>
      <button onclick="showSection('profile')" class="text-2xl hover:text-blue-600" title="Profile">üë§</button>
    </aside>

    <!-- Main Content -->
    <main class="flex-1 overflow-y-auto p-6 space-y-6">

<!-- Home Feed -->
      <section id="home" class="section">
        <h2 class="text-xl font-semibold mb-4">Home Feed</h2>
        <div class="space-y-4">
          <% posts.forEach(post => { %>
            <div class="bg-white rounded-lg shadow-md p-4">
              <div class="flex items-center mb-2">
                <img src="/default-avatar.png" class="h-10 w-10 rounded-full mr-3" alt="User" />
                <div>
                  <p class="font-semibold text-gray-700"><%= post.name %></p>
                  <small class="text-gray-500 text-xs"><%= post.role %> ‚Ä¢ <%= post.time %></small>
                </div>
              </div>
              <p class="mb-2"><%= post.content %></p>
              <% if (post.image) { %>
                <img src="<%= post.image %>" class="rounded-lg w-full object-cover max-h-96 mb-2" />
              <% } %>
              <div class="text-sm text-gray-500 flex space-x-4 mt-2">
                <span>üëç 0 Likes</span>
                <span>üí¨ 0 Comments</span>
              </div>
            </div>
          <% }) %>
        </div>
      </section>

      <!-- Chat Section -->
      <section id="chat" class="section hidden">
        <h2 class="text-xl font-semibold mb-4">Chat</h2>
        <div id="chat-box" class="bg-gray-100 p-2 h-64 overflow-y-auto mb-2"></div>
<form id="chat-form">
  <input id="chat-input" placeholder="Type a message..." class="border px-2 py-1 w-full">
</form>

<script src="/socket.io/socket.io.js"></script>
<script>
  const socket = io();
  const form = document.getElementById('chat-form');
  const input = document.getElementById('chat-input');
  const chatBox = document.getElementById('chat-box');

  form.addEventListener('submit', e => {
    e.preventDefault();
    socket.emit('chatMessage', input.value);
    input.value = '';
  });

  socket.on('chatMessage', msg => {
    const msgElem = document.createElement('div');
    msgElem.textContent = msg;
    chatBox.appendChild(msgElem);
    chatBox.scrollTop = chatBox.scrollHeight;
  });
</script>
      </section>

<!-- Create Post -->
<section id="post" class="section hidden">
    <h2 class="text-xl font-semibold mb-4">Create a Post</h2>
    <form action="/post" method="POST" enctype="multipart/form-data" class="space-y-3">
      <textarea name="content" placeholder="Write something..." class="w-full border p-2 rounded" required></textarea>
      <input type="file" name="image" accept="image/*" class="block" />
      <button type="submit" class="bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700">Post</button>
    </form>
  
    <h3 class="text-lg font-semibold mt-6 mb-4">Your Posts</h3>
    <% posts.forEach(post => { %>
      <div class="bg-white rounded-lg shadow-md p-4 space-y-2">
        <p><%= post.content %></p>
        
        <% if (post.image) { %>
          <img src="<%= post.image %>" class="w-full rounded max-h-80 object-cover" />
        <% } %>
  
        <div class="flex space-x-4 text-sm text-gray-500 mt-2">
          <form action="/post/<%= post._id %>/like" method="POST">
            <button>‚ù§Ô∏è Like (<%= post.likes %>)</button>
          </form>
          <span>üí¨ <%= post.comments.length %> Comments</span>
        </div>
  
        <ul class="text-sm text-gray-700">
          <% post.comments.forEach(comment => { %>
            <li>‚Ä¢ <strong><%= comment.user %>:</strong> <%= comment.text %></li>
          <% }) %>
        </ul>
  
        <form action="/post/<%= post._id %>/comment" method="POST" class="mt-2">
          <input name="text" placeholder="Add a comment..." class="border px-2 py-1 rounded w-full" required>
          <button class="text-blue-600 mt-1 hover:underline">Comment</button>
        </form>
      </div>
    <% }) %>
  </section>
  

<!-- Job Section -->
      <section id="jobs" class="section hidden">
        <h2 class="text-xl font-semibold mb-4">Job Updates</h2>
        <form action="/jobs" method="POST" class="space-y-3">
          <input name="title" placeholder="Job Title" class="w-full border rounded p-2" required />
          <textarea name="description" placeholder="Job Description" rows="3" class="w-full border rounded p-2"></textarea>
          <button class="bg-green-600 hover:bg-green-700 text-white px-4 py-2 rounded">Post Job</button>
        </form>
        <div class="mt-6 space-y-4">
          <% jobs.forEach(job => { %>
            <div class="bg-white p-4 rounded-lg shadow">
              <h3 class="text-lg font-semibold text-gray-800"><%= job.title %></h3>
              <p class="text-sm text-gray-600"><%= job.description %></p>
              <small class="text-gray-500 text-xs">Posted by: <%= job.role %></small>
            </div>
          <% }) %>
        </div>
      </section>

<!-- Profile -->
      <section id="profile" class="section hidden">
        <h2 class="text-xl font-semibold mb-4">Your Profile</h2>
        <p>This section will soon allow users to update profile details.</p>
      </section>
      
    </main>
  </div>

  <script>
    function showSection(id) {
      document.querySelectorAll('.section').forEach(section => section.classList.add('hidden'));
      document.getElementById(id).classList.remove('hidden');
    }
  </script>
</body>
</html>
